<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertex - Premium 3D Art Marketplace</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #667eea;
            --primary-dark: #5a6fd8;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --text-color: #1e293b;
            --text-light: #64748b;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --border-radius: 12px;
            --transition: all 0.3s ease;
            --focus-ring: 0 0 0 3px rgba(102, 126, 234, 0.3);
        }

        /* Dark Mode Variables */
        [data-theme="dark"] {
            --primary-color: #7c93e6;
            --primary-dark: #6a7fd4;
            --secondary-color: #8a68a8;
            --accent-color: #e586f0;
            --text-color: #e2e8f0;
            --text-light: #94a3b8;
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --glass-bg: rgba(30, 41, 59, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            font-size: 16px;
            transition: var(--transition);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Glassmorphism */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate {
            animation: fadeIn 0.5s ease;
        }

        /* Header */
        header {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            font-size: 28px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-color);
            white-space: nowrap;
        }

        .logo-tagline {
            font-size: 12px;
            color: var(--text-light);
            margin-top: -4px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-color);
        }

        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
            transform: rotate(15deg);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: var(--glass-bg);
            color: var(--text-color);
            border: 1px solid var(--glass-border);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .nav-btn:hover, .nav-btn.active {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .nav-btn i {
            font-size: 16px;
        }

        .mobile-menu-btn {
            display: none;
            background: var(--glass-bg);
            color: var(--text-color);
            border: 1px solid var(--glass-border);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        /* Auth modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 90%;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover,
        .modal-close:focus {
            color: var(--text-color);
            background: var(--bg-color);
        }

        .modal h2 {
            margin-bottom: 30px;
            color: var(--text-color);
            font-weight: 600;
        }

        .tab-container {
            display: flex;
            margin-bottom: 30px;
            border-radius: 30px;
            background: var(--bg-color);
            padding: 5px;
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 12px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 25px;
            transition: var(--transition);
            font-weight: 500;
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow);
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--text-light);
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .auth-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-top: 10px;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .error {
            color: var(--error-color);
            margin-top: 10px;
            font-size: 14px;
            text-align: left;
        }

        /* 3D Viewer Modal */
        .viewer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .viewer-content {
            width: 90%;
            height: 90%;
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }

        .viewer-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .viewer-close:hover,
        .viewer-close:focus {
            background: rgba(0,0,0,0.9);
            transform: scale(1.1);
        }

        #viewer-canvas {
            width: 100%;
            height: 100%;
        }

        /* Search and filter */
        .search-filter {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .search-container {
            flex: 1;
            position: relative;
            min-width: 250px;
        }

        #search {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 1px solid var(--text-light);
            border-radius: 25px;
            font-size: 16px;
            transition: var(--transition);
            background: var(--bg-color);
            color: var(--text-color);
        }

        #search:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn, .sort-btn {
            padding: 10px 20px;
            background: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--text-light);
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn:hover, .sort-btn:hover, 
        .filter-btn.active, .sort-btn.active,
        .filter-btn:focus, .sort-btn:focus {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Portfolio grid */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .portfolio-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .portfolio-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
        }

        .portfolio-image {
            height: 200px;
            background: linear-gradient(45deg, var(--accent-color), #f5576c);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
            position: relative;
        }

        .portfolio-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .portfolio-info {
            padding: 20px;
        }

        .portfolio-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .portfolio-description {
            color: var(--text-light);
            margin-bottom: 15px;
            font-size: 14px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-clamp: 2;
        }

        .portfolio-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .portfolio-price {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 18px;
        }

        .portfolio-tags {
            font-size: 12px;
            color: var(--text-light);
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .tag {
            background: var(--bg-color);
            padding: 3px 8px;
            border-radius: 10px;
        }

        .social-actions {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--text-light);
        }

        .like-btn, .comment-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-light);
            font-size: 14px;
        }

        .like-btn.liked {
            color: var(--error-color);
        }

        .like-btn:hover, .comment-btn:hover,
        .like-btn:focus, .comment-btn:focus {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        /* Profile view */
        .profile-header {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 20px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .profile-pic {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 20px;
            border: 4px solid white;
            position: relative;
            z-index: 1;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
        }

        .profile-role {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .profile-bio {
            font-size: 16px;
            margin-top: 10px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 1;
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.8;
        }

        /* Upload form */
        .upload-form {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .upload-area {
            border: 2px dashed var(--text-light);
            padding: 40px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
            transition: var(--transition);
            cursor: pointer;
        }

        .upload-area.dragover {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .upload-icon {
            font-size: 48px;
            color: var(--text-light);
            margin-bottom: 15px;
        }

        .upload-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
            transition: var(--transition);
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .upload-btn:hover,
        .upload-btn:focus {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: var(--bg-color);
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 5px;
        }

        /* Enhanced Messaging System */
        .messaging-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            height: 600px;
            display: flex;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .conversations-sidebar {
            width: 350px;
            border-right: 1px solid var(--text-light);
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
        }

        .conversations-header {
            padding: 20px;
            border-bottom: 1px solid var(--text-light);
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .conversations-search {
            padding: 0 20px 15px;
        }

        .conversations-search input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid var(--text-light);
            background: var(--bg-color);
            color: var(--text-color);
        }

        .conversations-list {
            flex: 1;
            overflow-y: auto;
        }

        .conversation-item {
            padding: 15px 20px;
            border-bottom: 1px solid var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .conversation-item:hover, .conversation-item.active {
            background: var(--primary-color);
            color: white;
        }

        .conversation-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .conversation-info {
            flex: 1;
        }

        .conversation-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .conversation-preview {
            font-size: 12px;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .conversation-time {
            font-size: 11px;
            opacity: 0.7;
        }

        .messaging-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .message-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--text-light);
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--card-bg);
        }

        .message-list {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: var(--bg-color);
        }

        .message {
            padding: 12px 16px;
            border-radius: 18px;
            max-width: 70%;
            animation: fadeIn 0.3s ease;
            position: relative;
        }

        .message.sent {
            background: var(--primary-color);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .message.received {
            background: var(--card-bg);
            color: var(--text-color);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            border: 1px solid var(--text-light);
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
        }

        .message-input-area {
            padding: 15px 20px;
            border-top: 1px solid var(--text-light);
            display: flex;
            gap: 10px;
            align-items: center;
            background: var(--card-bg);
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--text-light);
            border-radius: 25px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .send-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* Order Management */
        .orders-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .order-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--text-light);
            padding-bottom: 10px;
        }

        .order-tab {
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            background: var(--bg-color);
            color: var(--text-color);
            border: none;
        }

        .order-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .order-card {
            background: var(--bg-color);
            border-radius: var(--border-radius);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--text-light);
        }

        .order-info h4 {
            margin-bottom: 5px;
        }

        .order-status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-completed {
            background: #d1fae5;
            color: #059669;
        }

        /* AI Features Section */
        .ai-features {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .ai-feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .ai-feature-card {
            background: var(--bg-color);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
            border: 1px solid var(--text-light);
        }

        .ai-feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .ai-feature-icon {
            font-size: 36px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 3000;
            animation: fadeIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success {
            border-left: 4px solid var(--success-color);
        }

        .toast.error {
            border-left: 4px solid var(--error-color);
        }

        .toast.warning {
            border-left: 4px solid var(--warning-color);
        }

        .toast.info {
            border-left: 4px solid var(--info-color);
        }

        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .conversations-sidebar {
                width: 300px;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-wrap: wrap;
            }
            
            .logo-text {
                font-size: 20px;
            }
            
            .logo-tagline {
                display: none;
            }
            
            .nav-buttons {
                display: none;
                position: absolute;
                top: 80px;
                left: 0;
                right: 0;
                background: var(--card-bg);
                flex-direction: column;
                padding: 15px;
                border-radius: var(--border-radius);
                box-shadow: var(--shadow-lg);
                z-index: 100;
            }
            
            .nav-buttons.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .messaging-container {
                flex-direction: column;
                height: 80vh;
            }
            
            .conversations-sidebar {
                width: 100%;
                height: 40%;
            }
            
            .messaging-area {
                height: 60%;
            }
            
            .portfolio-grid {
                grid-template-columns: 1fr;
            }
            
            .search-filter {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-container {
                min-width: 100%;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .logo-text {
                font-size: 18px;
            }
            
            .header-controls {
                gap: 8px;
            }
            
            .theme-toggle, .mobile-menu-btn {
                width: 40px;
                height: 40px;
            }
            
            .ai-feature-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hidden classes */
        .hidden {
            display: none !important;
        }

        .view {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Auth Modal -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAuthModal()" aria-label="Close authentication modal">Ã—</button>
            <h2>Welcome to Vertex</h2>
            <p style="color: var(--text-light); margin-bottom: 20px;">Join our community of 3D artists and enthusiasts</p>
            
            <div class="tab-container">
                <button class="tab-btn active" onclick="switchTab('login')">Login</button>
                <button class="tab-btn" onclick="switchTab('signup')">Sign Up</button>
            </div>
            
            <div id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password" required>
                </div>
                <button class="auth-btn" onclick="login()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <div id="login-error" class="error"></div>
            </div>
            
            <div id="signup-form" class="hidden">
                <div class="form-group">
                    <label for="signup-username">Username</label>
                    <input type="text" id="signup-username" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password" required>
                </div>
                <div class="form-group">
                    <label for="signup-account-type">Account Type</label>
                    <select id="signup-account-type" required>
                        <option value="client">Artist/Viewer</option>
                        <option value="seller">Creator</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="signup-bio">Bio</label>
                    <textarea id="signup-bio" rows="3" placeholder="Tell us about yourself..."></textarea>
                </div>
                <button class="auth-btn" onclick="signup()">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                <div id="signup-error" class="error"></div>
            </div>
        </div>
    </div>

    <!-- 3D Viewer Modal -->
    <div id="viewer-modal" class="viewer-modal hidden">
        <div class="viewer-content">
            <button class="viewer-close" onclick="closeViewer()">
                <i class="fas fa-times"></i>
            </button>
            <canvas id="viewer-canvas"></canvas>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden">
        <header class="glass">
            <div class="logo-container">
                <div class="logo-icon">
                    <i class="fas fa-cube"></i>
                </div>
                <div>
                    <div class="logo-text">Vertex</div>
                    <div class="logo-tagline">3D Art Marketplace</div>
                </div>
            </div>
            
            <div class="header-controls">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                
                <nav class="nav-buttons" id="nav-buttons">
                    <button class="nav-btn active" onclick="switchView('feed')">
                        <i class="fas fa-home"></i> <span>Feed</span>
                    </button>
                    <button class="nav-btn" onclick="switchView('profile')">
                        <i class="fas fa-user"></i> <span>Profile</span>
                    </button>
                    <button class="nav-btn" onclick="switchView('portfolio')">
                        <i class="fas fa-upload"></i> <span>Upload</span>
                    </button>
                    <button class="nav-btn" onclick="switchView('messages')">
                        <i class="fas fa-comments"></i> <span>Messages</span>
                    </button>
                    <button class="nav-btn" onclick="switchView('orders')">
                        <i class="fas fa-shopping-bag"></i> <span>Orders</span>
                    </button>
                    <button class="nav-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
                    </button>
                </nav>
                
                <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </header>

        <div class="container">
            <!-- Feed View -->
            <div id="feed-view" class="view">
                <div class="search-filter">
                    <div class="search-container">
                        <input type="text" id="search" placeholder="Search portfolios, artists, tags...">
                        <div class="search-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="filter-container">
                        <button class="filter-btn" onclick="filterByDimension('all')">
                            <i class="fas fa-th"></i> All
                        </button>
                        <button class="filter-btn" onclick="filterByDimension('2D')">
                            <i class="fas fa-image"></i> 2D
                        </button>
                        <button class="filter-btn active" onclick="filterByDimension('3D')">
                            <i class="fas fa-cube"></i> 3D
                        </button>
                        <button class="sort-btn" onclick="sortPortfolios('popularity')">
                            <i class="fas fa-fire"></i> Popular
                        </button>
                        <button class="sort-btn active" onclick="sortPortfolios('recent')">
                            <i class="fas fa-clock"></i> Recent
                        </button>
                    </div>
                </div>
                
                <div class="portfolio-grid" id="portfolio-grid">
                    <div class="spinner" id="loading-spinner"></div>
                </div>

                <!-- AI Features Section -->
                <section class="ai-features">
                    <h3>AI-Powered Features</h3>
                    <p>Enhance your 3D workflow with our AI tools</p>
                    
                    <div class="ai-feature-grid">
                        <div class="ai-feature-card">
                            <div class="ai-feature-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h4>AI Model Generator</h4>
                            <p>Generate 3D models from text descriptions using advanced AI</p>
                            <button class="upload-btn" onclick="openAIModelGenerator()">Try Now</button>
                        </div>
                        
                        <div class="ai-feature-card">
                            <div class="ai-feature-icon">
                                <i class="fas fa-palette"></i>
                            </div>
                            <h4>Smart Texturing</h4>
                            <p>Automatically generate textures and materials for your models</p>
                            <button class="upload-btn" onclick="openAITexturing()">Try Now</button>
                        </div>
                        
                        <div class="ai-feature-card">
                            <div class="ai-feature-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h4>Style Transfer</h4>
                            <p>Apply artistic styles to your 3D models with AI</p>
                            <button class="upload-btn" onclick="openAIStyleTransfer()">Try Now</button>
                        </div>
                        
                        <div class="ai-feature-card">
                            <div class="ai-feature-icon">
                                <i class="fas fa-magic"></i>
                            </div>
                            <h4>Auto-Rigging</h4>
                            <p>Automatically rig characters for animation with AI assistance</p>
                            <button class="upload-btn" onclick="openAIRigging()">Try Now</button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Profile View -->
            <div id="profile-view" class="view hidden">
                <div class="profile-header">
                    <img id="profile-pic" class="profile-pic" src="https://via.placeholder.com/100" alt="Profile Picture">
                    <h2 id="profile-name" class="profile-name">Username</h2>
                    <p id="profile-role" class="profile-role">Artist</p>
                    <p id="profile-bio" class="profile-bio">No bio yet. Click edit to add one.</p>
                    
                    <div class="profile-stats">
                        <div class="stat">
                            <div class="stat-value" id="stat-portfolios">0</div>
                            <div class="stat-label">Portfolios</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="stat-likes">0</div>
                            <div class="stat-label">Likes</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="stat-followers">0</div>
                            <div class="stat-label">Followers</div>
                        </div>
                    </div>
                    
                    <button class="nav-btn" style="margin-top: 20px;" onclick="editProfile()">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
                
                <h3 style="margin-bottom: 20px;">Your Portfolios</h3>
                <div class="portfolio-grid" id="user-portfolios">
                    <!-- User portfolios will be populated by JS -->
                </div>
            </div>

            <!-- Portfolio View (Upload) -->
            <div id="portfolio-view" class="view hidden">
                <div class="upload-form">
                    <h2 style="margin-bottom: 20px;">Upload New Portfolio</h2>
                    
                    <div class="form-group">
                        <label for="portfolio-title">Title</label>
                        <input type="text" id="portfolio-title" placeholder="Enter a title for your work" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="portfolio-description">Description</label>
                        <textarea id="portfolio-description" rows="3" placeholder="Describe your work..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="portfolio-price">Price ($)</label>
                        <input type="number" id="portfolio-price" step="0.01" placeholder="0.00" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="portfolio-category">Category</label>
                        <input type="text" id="portfolio-category" placeholder="e.g., Character, Environment, Prop" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="portfolio-dimension">Dimension</label>
                        <select id="portfolio-dimension" required>
                            <option value="3D">3D</option>
                            <option value="2D">2D</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="portfolio-tags">Tags (comma-separated)</label>
                        <input type="text" id="portfolio-tags" placeholder="e.g., fantasy, character, model">
                    </div>
                    
                    <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>Drag and drop your 3D/2D files here or click to browse</p>
                        <p style="font-size: 14px; color: var(--text-light);">Supported formats: .glb, .gltf, .obj, .fbx, .png, .jpg, .jpeg</p>
                        <input type="file" id="file-input" multiple accept=".glb,.gltf,.obj,.fbx,.png,.jpg,.jpeg" style="display: none;">
                        <button class="upload-btn">
                            <i class="fas fa-folder-open"></i> Choose Files
                        </button>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                    
                    <button class="auth-btn" onclick="uploadPortfolio()">
                        <i class="fas fa-upload"></i> Upload Portfolio
                    </button>
                </div>
            </div>

            <!-- Messages View -->
            <div id="messages-view" class="view hidden">
                <h2 style="margin-bottom: 20px;">Messages</h2>
                
                <div class="messaging-container">
                    <div class="conversations-sidebar">
                        <div class="conversations-header">
                            <h3>Conversations</h3>
                            <button class="nav-btn" style="margin-left: auto;">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        
                        <div class="conversations-search">
                            <input type="text" placeholder="Search conversations...">
                        </div>
                        
                        <div class="conversations-list">
                            <div class="conversation-item active">
                                <div class="conversation-avatar">JD</div>
                                <div class="conversation-info">
                                    <div class="conversation-name">John Designer</div>
                                    <div class="conversation-preview">Hi, I'm interested in your dragon model...</div>
                                </div>
                                <div class="conversation-time">2h ago</div>
                            </div>
                            
                            <div class="conversation-item">
                                <div class="conversation-avatar">AS</div>
                                <div class="conversation-info">
                                    <div class="conversation-name">Alice Sculptor</div>
                                    <div class="conversation-preview">Thanks for the quick response!</div>
                                </div>
                                <div class="conversation-time">1d ago</div>
                            </div>
                            
                            <div class="conversation-item">
                                <div class="conversation-avatar">MR</div>
                                <div class="conversation-info">
                                    <div class="conversation-name">Mike Render</div>
                                    <div class="conversation-preview">Can you share the texture files?</div>
                                </div>
                                <div class="conversation-time">3d ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="messaging-area">
                        <div class="message-header">
                            <div class="conversation-avatar">JD</div>
                            <div class="conversation-info">
                                <div class="conversation-name">John Designer</div>
                                <div class="conversation-preview">Online</div>
                            </div>
                            <button class="nav-btn" style="margin-left: auto;">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="nav-btn">
                                <i class="fas fa-video"></i>
                            </button>
                        </div>
                        
                        <div class="message-list" id="message-list">
                            <div class="message received">
                                <div>Hi, I'm interested in your dragon model. Do you offer any customization services?</div>
                                <div class="message-time">10:24 AM</div>
                            </div>
                            
                            <div class="message sent">
                                <div>Hello! Yes, I do offer customization. What did you have in mind?</div>
                                <div class="message-time">10:26 AM</div>
                            </div>
                            
                            <div class="message received">
                                <div>I'd like to change the color scheme to match my game's aesthetic. Could you make it more ice-themed?</div>
                                <div class="message-time">10:28 AM</div>
                            </div>
                            
                            <div class="message sent">
                                <div>Absolutely! I can create an ice variant with blue/white coloring and frost effects. Would you like me to prepare a quote?</div>
                                <div class="message-time">10:30 AM</div>
                            </div>
                        </div>
                        
                        <div class="message-input-area">
                            <input type="text" class="message-input" id="message-text" placeholder="Type your message...">
                            <button class="send-btn" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders View -->
            <div id="orders-view" class="view hidden">
                <h2 style="margin-bottom: 20px;">Order Management</h2>
                
                <div class="orders-container">
                    <div class="order-tabs">
                        <button class="order-tab active">Active Orders</button>
                        <button class="order-tab">Completed</button>
                        <button class="order-tab">Cancelled</button>
                    </div>
                    
                    <div class="orders-list">
                        <div class="order-card">
                            <div class="order-info">
                                <h4>Fantasy Dragon Customization</h4>
                                <p>Order #12345 â€¢ John Designer</p>
                                <p>Placed on Oct 15, 2023</p>
                            </div>
                            <div class="order-actions">
                                <span class="order-status status-pending">In Progress</span>
                                <button class="nav-btn" style="margin-top: 10px;">
                                    <i class="fas fa-comment"></i> Message
                                </button>
                            </div>
                        </div>
                        
                        <div class="order-card">
                            <div class="order-info">
                                <h4>Sci-Fi Spaceship</h4>
                                <p>Order #12344 â€¢ Sarah Developer</p>
                                <p>Placed on Oct 12, 2023</p>
                            </div>
                            <div class="order-actions">
                                <span class="order-status status-completed">Completed</span>
                                <button class="nav-btn" style="margin-top: 10px;">
                                    <i class="fas fa-comment"></i> Message
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js"></script>
    <script>
        // Global variables
        let currentUser = null;
        let currentView = 'feed';
        let socket;
        let scene, camera, renderer, controls;
        let currentPortfolios = [];
        let currentFilter = '3D';
        let currentSort = 'recent';
        let selectedConversation = null;

        // Demo 3D models data
        const demoModels = [
            {
                id: 1,
                title: "Fantasy Dragon",
                description: "A majestic fantasy dragon with detailed scales and wings. Perfect for game characters or animations.",
                price: 49.99,
                category: "Characters",
                dimension: "3D",
                tags: "fantasy,dragon,creature,mythical",
                likes: 42,
                created_at: "2023-10-15T14:30:00Z",
                model_type: "character"
            },
            {
                id: 2,
                title: "Sci-Fi Space Station",
                description: "Detailed sci-fi space station with modular design. Includes interior and exterior models.",
                price: 79.99,
                category: "Environments",
                dimension: "3D",
                tags: "sci-fi,space,futuristic,environment",
                likes: 28,
                created_at: "2023-10-12T09:15:00Z",
                model_type: "environment"
            },
            {
                id: 3,
                title: "Medieval Sword",
                description: "Highly detailed medieval sword with PBR materials. Game-ready with optimized topology.",
                price: 19.99,
                category: "Props",
                dimension: "3D",
                tags: "weapon,medieval,fantasy,prop",
                likes: 15,
                created_at: "2023-10-10T16:45:00Z",
                model_type: "prop"
            }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            setupEventListeners();
            initializeTheme();
        });

        // Theme Management
        function initializeTheme() {
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = themeToggle.querySelector('i');
            
            // Check for saved theme or prefer color scheme
            const savedTheme = localStorage.getItem('theme') || 
                              (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            
            // Apply the saved theme
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
            
            // Toggle theme
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });
            
            function updateThemeIcon(theme) {
                themeIcon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }
        }

        // Mobile Menu Toggle
        function setupEventListeners() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const navButtons = document.getElementById('nav-buttons');
            
            mobileMenuBtn.addEventListener('click', () => {
                navButtons.classList.toggle('active');
                mobileMenuBtn.querySelector('i').className = 
                    navButtons.classList.contains('active') ? 'fas fa-times' : 'fas fa-bars';
            });
            
            // Search functionality
            document.getElementById('search').addEventListener('input', debounce(searchPortfolios, 300));
            
            // File upload drag and drop
            const uploadArea = document.getElementById('upload-area');
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                document.getElementById('file-input').files = files;
                showToast('Files selected', 'success');
            });
            
            // Message sending
            document.getElementById('message-text').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Order tabs
            const orderTabs = document.querySelectorAll('.order-tab');
            orderTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    orderTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                });
            });

            // Conversation selection
            const conversationItems = document.querySelectorAll('.conversation-item');
            conversationItems.forEach(item => {
                item.addEventListener('click', () => {
                    conversationItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    selectedConversation = {
                        id: 1,
                        otherUser: { id: 2, username: 'John Designer' }
                    };
                });
            });
        }

        // Debounce function for search
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Check authentication
        async function checkAuth() {
            const token = localStorage.getItem('token');
            if (token) {
                try {
                    document.getElementById('loading-spinner').classList.remove('hidden');
                    
                    // Simulate API call
                    setTimeout(() => {
                        currentUser = {
                            id: 1,
                            username: 'DemoUser',
                            email: 'demo@example.com',
                            accountType: 'seller',
                            bio: '3D artist and enthusiast',
                            profile_pic: 'https://via.placeholder.com/100'
                        };
                        document.getElementById('auth-modal').classList.add('hidden');
                        document.getElementById('app').classList.remove('hidden');
                        initSocket();
                        loadView();
                        document.getElementById('loading-spinner').classList.add('hidden');
                    }, 1000);
                } catch (err) {
                    showAuthModal();
                }
            } else {
                showAuthModal();
            }
        }

        // Show auth modal
        function showAuthModal() {
            document.getElementById('auth-modal').classList.remove('hidden');
            document.getElementById('app').classList.add('hidden');
        }

        // Close auth modal
        function closeAuthModal() {
            document.getElementById('auth-modal').classList.add('hidden');
        }

        // Initialize Socket.io
        function initSocket() {
            // Simulate socket connection
            socket = {
                emit: (event, data) => console.log('Socket emit:', event, data),
                on: (event, callback) => {
                    if (event === 'receiveMessage') {
                        // Simulate receiving a message after 5 seconds
                        setTimeout(() => {
                            callback({
                                id: Date.now(),
                                sender_id: 2,
                                senderName: 'OtherUser',
                                text: 'Hello! I like your portfolio work.',
                                created_at: new Date().toISOString()
                            });
                        }, 5000);
                    }
                },
                disconnect: () => console.log('Socket disconnected')
            };
        }

        // Switch views
        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(view + '-view').classList.remove('hidden');
            
            // Update active nav button
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Close mobile menu if open
            const navButtons = document.getElementById('nav-buttons');
            if (navButtons.classList.contains('active')) {
                navButtons.classList.remove('active');
                document.getElementById('mobile-menu-btn').querySelector('i').className = 'fas fa-bars';
            }
            
            loadView();
        }

        // Load current view content
        async function loadView() {
            if (currentView === 'feed') {
                await loadPortfolios();
            } else if (currentView === 'profile') {
                loadProfile();
            } else if (currentView === 'portfolio') {
                // Portfolio upload view is static
            } else if (currentView === 'messages') {
                // Messages view is already populated
            }
        }

        // Load portfolios
        async function loadPortfolios() {
            try {
                document.getElementById('loading-spinner').classList.remove('hidden');
                // Use demo data
                currentPortfolios = demoModels;
                displayPortfolios(currentPortfolios);
            } catch (err) {
                console.error('Error loading portfolios:', err);
                showToast('Error loading portfolios', 'error');
            } finally {
                document.getElementById('loading-spinner').classList.add('hidden');
            }
        }

        // Display portfolios
        function displayPortfolios(portfolios) {
            const grid = document.getElementById('portfolio-grid');
            
            if (portfolios.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-light);">
                        <i class="fas fa-box-open" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <h3>No portfolios found</h3>
                        <p>Try adjusting your search or filters</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = '';
            portfolios.forEach(portfolio => {
                const card = document.createElement('div');
                card.className = 'portfolio-card animate';
                card.innerHTML = `
                    <div class="portfolio-image">
                        <i class="fas fa-${portfolio.dimension === '3D' ? 'cube' : 'image'}"></i>
                        <div class="portfolio-badge">${portfolio.dimension}</div>
                    </div>
                    <div class="portfolio-info">
                        <div class="portfolio-title">${portfolio.title}</div>
                        <div class="portfolio-description">${portfolio.description}</div>
                        <div class="portfolio-meta">
                            <span class="portfolio-price">$${parseFloat(portfolio.price).toFixed(2)}</span>
                            <div class="portfolio-tags">
                                ${portfolio.tags.split(',').map(tag => 
                                    `<span class="tag">${tag.trim()}</span>`
                                ).join('')}
                            </div>
                        </div>
                        <div class="social-actions">
                            <button class="like-btn" onclick="event.stopPropagation(); toggleLike(${portfolio.id})">
                                <i class="far fa-heart"></i> <span id="likes-${portfolio.id}">${portfolio.likes}</span>
                            </button>
                            <button class="comment-btn" onclick="event.stopPropagation(); showComments(${portfolio.id})">
                                <i class="far fa-comment"></i> <span id="comments-count-${portfolio.id}">0</span>
                            </button>
                        </div>
                    </div>
                `;
                card.onclick = () => viewPortfolio(portfolio);
                grid.appendChild(card);
            });
        }

        // Search portfolios
        function searchPortfolios() {
            const query = document.getElementById('search').value.toLowerCase();
            if (!query) {
                displayPortfolios(currentPortfolios);
                return;
            }
            
            const filtered = currentPortfolios.filter(p => 
                p.title.toLowerCase().includes(query) || 
                p.description.toLowerCase().includes(query) ||
                p.tags.toLowerCase().includes(query)
            );
            displayPortfolios(filtered);
        }

        // Filter by dimension
        function filterByDimension(dimension) {
            currentFilter = dimension;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const filtered = dimension === 'all' ? 
                currentPortfolios : 
                currentPortfolios.filter(p => p.dimension === dimension);
            displayPortfolios(filtered);
        }

        // Sort portfolios
        function sortPortfolios(sortBy) {
            currentSort = sortBy;
            
            // Update active sort button
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            let sorted = [...currentPortfolios];
            if (sortBy === 'popularity') {
                sorted.sort((a, b) => b.likes - a.likes);
            } else {
                sorted.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
            }
            displayPortfolios(sorted);
        }

        // View portfolio in 3D viewer
        function viewPortfolio(portfolio) {
            document.getElementById('viewer-modal').classList.remove('hidden');
            init3DViewer(portfolio);
        }

        // Initialize 3D viewer with demo models
        function init3DViewer(portfolio) {
            const canvas = document.getElementById('viewer-canvas');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setClearColor(0x222222);

            // Add lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);

            // Create different demo models based on portfolio type
            let model;
            switch(portfolio.model_type) {
                case 'character':
                    // Create a character-like model (simplified dragon)
                    const bodyGeometry = new THREE.SphereGeometry(1, 16, 16);
                    const bodyMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x667eea,
                        shininess: 100
                    });
                    model = new THREE.Mesh(bodyGeometry, bodyMaterial);
                    
                    // Add wings
                    const wingGeometry = new THREE.PlaneGeometry(2, 1);
                    const wingMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x764ba2,
                        side: THREE.DoubleSide
                    });
                    const leftWing = new THREE.Mesh(wingGeometry, wingMaterial);
                    leftWing.rotation.z = Math.PI / 4;
                    leftWing.position.set(-1, 0.5, 0);
                    model.add(leftWing);
                    
                    const rightWing = new THREE.Mesh(wingGeometry, wingMaterial);
                    rightWing.rotation.z = -Math.PI / 4;
                    rightWing.position.set(1, 0.5, 0);
                    model.add(rightWing);
                    break;
                    
                case 'environment':
                    // Create environment model (space station)
                    const stationGeometry = new THREE.TorusGeometry(2, 0.5, 16, 100);
                    const stationMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x888888,
                        shininess: 30
                    });
                    model = new THREE.Mesh(stationGeometry, stationMaterial);
                    break;
                    
                case 'prop':
                    // Create weapon model (sword)
                    const bladeGeometry = new THREE.BoxGeometry(0.2, 3, 0.1);
                    const bladeMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0xcccccc,
                        shininess: 300
                    });
                    const blade = new THREE.Mesh(bladeGeometry, bladeMaterial);
                    
                    const hiltGeometry = new THREE.BoxGeometry(0.4, 0.5, 0.4);
                    const hiltMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x8B4513
                    });
                    const hilt = new THREE.Mesh(hiltGeometry, hiltMaterial);
                    hilt.position.y = -1.8;
                    
                    model = new THREE.Group();
                    model.add(blade);
                    model.add(hilt);
                    break;
                    
                default:
                    // Default cube
                    const geometry = new THREE.BoxGeometry(1, 1, 1);
                    const material = new THREE.MeshPhongMaterial({ 
                        color: 0x667eea,
                        shininess: 100
                    });
                    model = new THREE.Mesh(geometry, material);
            }

            scene.add(model);

            // Add a ground plane
            const planeGeometry = new THREE.PlaneGeometry(10, 10);
            const planeMaterial = new THREE.MeshPhongMaterial({ 
                color: 0x444444,
                side: THREE.DoubleSide
            });
            const plane = new THREE.Mesh(planeGeometry, planeMaterial);
            plane.rotation.x = Math.PI / 2;
            plane.position.y = -2;
            scene.add(plane);

            camera.position.z = 5;

            // Simple mouse controls
            let mouseX = 0, mouseY = 0;
            let isDragging = false;
            
            canvas.addEventListener('mousedown', () => isDragging = true);
            canvas.addEventListener('mouseup', () => isDragging = false);
            canvas.addEventListener('mousemove', (event) => {
                if (isDragging) {
                    mouseX = (event.clientX / window.innerWidth) * 2 - 1;
                    mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
                }
            });

            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate based on mouse position
                if (model && isDragging) {
                    model.rotation.y += mouseX * 0.05;
                    model.rotation.x += mouseY * 0.05;
                } else if (model) {
                    model.rotation.y += 0.01;
                }
                
                renderer.render(scene, camera);
            }
            animate();

            // Handle window resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            });
        }

        // Close 3D viewer
        function closeViewer() {
            document.getElementById('viewer-modal').classList.add('hidden');
            if (renderer) {
                renderer.dispose();
            }
        }

        // Load profile
        function loadProfile() {
            document.getElementById('profile-name').textContent = currentUser.username;
            document.getElementById('profile-role').textContent = currentUser.accountType === 'seller' ? 'Creator' : 'Artist';
            document.getElementById('profile-bio').textContent = currentUser.bio || 'No bio yet. Click edit to add one.';
            document.getElementById('profile-pic').src = currentUser.profile_pic || 'https://via.placeholder.com/100';
            
            // Placeholder stats
            document.getElementById('stat-portfolios').textContent = '3';
            document.getElementById('stat-likes').textContent = '127';
            document.getElementById('stat-followers').textContent = '89';
            
            loadUserPortfolios();
        }

        // Load user portfolios
        async function loadUserPortfolios() {
            try {
                // Use first 3 demo models as user portfolios
                const userPortfolios = demoModels.slice(0, 3);
                const grid = document.getElementById('user-portfolios');
                grid.innerHTML = '';
                
                if (userPortfolios.length === 0) {
                    grid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-upload" style="font-size: 48px; margin-bottom: 15px;"></i>
                            <h3>No portfolios yet</h3>
                            <p>Upload your first portfolio to get started</p>
                            <button class="nav-btn" style="margin-top: 15px;" onclick="switchView('portfolio')">
                                <i class="fas fa-upload"></i> Upload Portfolio
                            </button>
                        </div>
                    `;
                    return;
                }
                
                userPortfolios.forEach(portfolio => {
                    const card = document.createElement('div');
                    card.className = 'portfolio-card';
                    card.innerHTML = `
                        <div class="portfolio-image">
                            <i class="fas fa-${portfolio.dimension === '3D' ? 'cube' : 'image'}"></i>
                            <div class="portfolio-badge">${portfolio.dimension}</div>
                        </div>
                        <div class="portfolio-info">
                            <div class="portfolio-title">${portfolio.title}</div>
                            <div class="portfolio-price">$${parseFloat(portfolio.price).toFixed(2)}</div>
                        </div>
                    `;
                    card.onclick = () => viewPortfolio(portfolio);
                    grid.appendChild(card);
                });
            } catch (err) {
                console.error('Error loading user portfolios:', err);
                showToast('Error loading your portfolios', 'error');
            }
        }

        // Edit profile
        function editProfile() {
            const newBio = prompt('Enter new bio:', currentUser.bio || '');
            if (newBio !== null) {
                updateProfile({ bio: newBio });
            }
        }

        // Update profile
        async function updateProfile(updates) {
            try {
                // Simulate API call
                setTimeout(() => {
                    Object.assign(currentUser, updates);
                    loadProfile();
                    showToast('Profile updated successfully', 'success');
                }, 500);
            } catch (err) {
                console.error('Error updating profile:', err);
                showToast('Error updating profile', 'error');
            }
        }

        // Upload portfolio
        async function uploadPortfolio() {
            const title = document.getElementById('portfolio-title').value;
            const description = document.getElementById('portfolio-description').value;
            const price = document.getElementById('portfolio-price').value;
            const category = document.getElementById('portfolio-category').value;
            const dimension = document.getElementById('portfolio-dimension').value;
            const tags = document.getElementById('portfolio-tags').value;

            if (!title || !price || !category) {
                showToast('Please fill all required fields', 'warning');
                return;
            }

            // Show upload progress
            const progressFill = document.getElementById('progress-fill');
            progressFill.style.width = '0%';

            // Simulate upload process
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressFill.style.width = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // Add new portfolio to demo data
                    const newPortfolio = {
                        id: demoModels.length + 1,
                        title,
                        description,
                        price: parseFloat(price),
                        category,
                        dimension,
                        tags,
                        likes: 0,
                        created_at: new Date().toISOString(),
                        model_type: 'custom'
                    };
                    
                    demoModels.unshift(newPortfolio);
                    currentPortfolios = demoModels;
                    
                    showToast('Portfolio uploaded successfully!', 'success');
                    
                    // Reset form
                    document.getElementById('portfolio-title').value = '';
                    document.getElementById('portfolio-description').value = '';
                    document.getElementById('portfolio-price').value = '';
                    document.getElementById('portfolio-category').value = '';
                    document.getElementById('portfolio-tags').value = '';
                    document.getElementById('file-input').value = '';
                    progressFill.style.width = '0%';
                    
                    setTimeout(() => {
                        switchView('profile');
                    }, 1500);
                }
            }, 100);
        }

        // Toggle like
        async function toggleLike(portfolioId) {
            try {
                const portfolio = demoModels.find(p => p.id === portfolioId);
                if (portfolio) {
                    portfolio.likes += 1;
                    document.getElementById(`likes-${portfolioId}`).textContent = portfolio.likes;
                    const likeBtn = document.querySelector(`#likes-${portfolioId}`).closest('.like-btn');
                    likeBtn.classList.add('liked');
                    likeBtn.querySelector('i').classList.replace('far', 'fas');
                    showToast('Liked portfolio!', 'success');
                }
            } catch (err) {
                console.error('Error toggling like:', err);
            }
        }

        // Send message
        function sendMessage() {
            if (!selectedConversation) {
                showToast('Please select a conversation first', 'warning');
                return;
            }
            
            const input = document.getElementById('message-text');
            if (input.value.trim()) {
                const text = input.value.trim();
                const messageList = document.getElementById('message-list');
                
                // Display sent message immediately
                const messageElement = document.createElement('div');
                messageElement.className = 'message sent';
                messageElement.innerHTML = `
                    <div>${text}</div>
                    <div class="message-time">Just now</div>
                `;
                messageList.appendChild(messageElement);
                
                // Simulate response after 1-3 seconds
                setTimeout(() => {
                    const responses = [
                        "That's interesting! Tell me more.",
                        "I'd love to collaborate on a project sometime.",
                        "Your work is really inspiring.",
                        "Do you have any tips for beginners?",
                        "What software do you recommend for 3D modeling?"
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const replyElement = document.createElement('div');
                    replyElement.className = 'message received';
                    replyElement.innerHTML = `
                        <div>${randomResponse}</div>
                        <div class="message-time">Just now</div>
                    `;
                    messageList.appendChild(replyElement);
                    messageList.scrollTop = messageList.scrollHeight;
                }, 1000 + Math.random() * 2000);
                
                input.value = '';
                messageList.scrollTop = messageList.scrollHeight;
            }
        }

        // AI Feature Functions
        function openAIModelGenerator() {
            showToast('AI Model Generator launched! Describe what you want to create.', 'info');
        }

        function openAITexturing() {
            showToast('AI Texturing tool opened. Upload your model to generate textures.', 'info');
        }

        function openAIStyleTransfer() {
            showToast('AI Style Transfer activated. Choose a style to apply to your model.', 'info');
        }

        function openAIRigging() {
            showToast('AI Auto-Rigging started. Upload your character model to begin.', 'info');
        }

        // Switch auth tabs
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add('active');
            if (tab === 'login') {
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('signup-form').classList.add('hidden');
            } else {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('signup-form').classList.remove('hidden');
            }
        }

        // Login
        async function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorDiv = document.getElementById('login-error');
            errorDiv.textContent = '';

            try {
                // Simulate API call
                setTimeout(() => {
                    if (email && password) {
                        currentUser = {
                            id: 1,
                            username: 'DemoUser',
                            email: email,
                            accountType: 'seller',
                            bio: '3D artist and enthusiast',
                            profile_pic: 'https://via.placeholder.com/100'
                        };
                        localStorage.setItem('token', 'demo-token');
                        document.getElementById('auth-modal').classList.add('hidden');
                        document.getElementById('app').classList.remove('hidden');
                        initSocket();
                        loadView();
                        showToast(`Welcome back, ${currentUser.username}!`, 'success');
                    } else {
                        errorDiv.textContent = 'Please enter both email and password';
                    }
                }, 1000);
            } catch (err) {
                errorDiv.textContent = 'Network error';
            }
        }

        // Signup
        async function signup() {
            const username = document.getElementById('signup-username').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const accountType = document.getElementById('signup-account-type').value;
            const bio = document.getElementById('signup-bio').value;
            const errorDiv = document.getElementById('signup-error');
            errorDiv.textContent = '';

            try {
                // Simulate API call
                setTimeout(() => {
                    if (username && email && password) {
                        currentUser = {
                            id: 1,
                            username: username,
                            email: email,
                            accountType: accountType,
                            bio: bio,
                            profile_pic: 'https://via.placeholder.com/100'
                        };
                        localStorage.setItem('token', 'demo-token');
                        document.getElementById('auth-modal').classList.add('hidden');
                        document.getElementById('app').classList.remove('hidden');
                        initSocket();
                        loadView();
                        showToast(`Welcome to Vertex, ${currentUser.username}!`, 'success');
                    } else {
                        errorDiv.textContent = 'Please fill all required fields';
                    }
                }, 1000);
            } catch (err) {
                errorDiv.textContent = 'Network error';
            }
        }

        // Logout
        function logout() {
            localStorage.removeItem('token');
            currentUser = null;
            if (socket) socket.disconnect();
            document.getElementById('auth-modal').classList.remove('hidden');
            document.getElementById('app').classList.add('hidden');
            showToast('You have been logged out', 'info');
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="${icons[type]}"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(toast);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>